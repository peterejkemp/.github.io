<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>MASTEMR - 11 Selecting statistical tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/htmlwidgets-1.6.3/htmlwidgets.js"></script><script src="../site_libs/d3-3.3.8/d3.min.js"></script><script src="../site_libs/dagre-0.4.0/dagre-d3.min.js"></script><link href="../site_libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="../site_libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="../site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="../site_libs/chromatography-0.1/chromatography.js"></script><script src="../site_libs/DiagrammeR-binding-1.0.10/DiagrammeR.js"></script><link rel="stylesheet" href="../css/mastemr.css">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="index.qmd" class="navbar-brand navbar-brand-logo">
    <img src="../images/KCL_logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="index.qmd">
    <span class="navbar-title">MASTEMR</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/11-selecting_statistical_tools.html">11 Selecting statistical tools</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Sessions</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-Intro_to_quant_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">02 Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-1-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-2-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading packages and exploring data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-3-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Piping and dplyr</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-4-Intro_to_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Making graphs</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-Descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 Descriptive Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-Presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 Presentations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-Introduction_to_PISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 Introduction to PISA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-ChisqPISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07 Hypothesis testing and Chi-square tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-T-testsPISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06 T-tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-Writing_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08 Writing a quantitative report</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-Assignment_3_tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09 Assignment 3 tutorials</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-Correlation_and_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 Correlation and regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-selecting_statistical_tools.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">11 Selecting statistical tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-value_of_quant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12 The value of quantitative methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/QandA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Questions and Answers</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendicies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A1-PISA_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PISA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A2-DfE_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DfE England</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A3-TIMSS_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TIMSS, PIRLS and ICILS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A4-Other_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A5-Self_Study_Tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix Self Study Tasks</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#pre-session-tasks" id="toc-pre-session-tasks" class="nav-link active" data-scroll-target="#pre-session-tasks"><span class="header-section-number">1</span> Pre-session tasks</a>
  <ul class="collapse">
<li><a href="#pre-session-reading" id="toc-pre-session-reading" class="nav-link" data-scroll-target="#pre-session-reading"><span class="header-section-number">1.1</span> Pre-session reading</a></li>
  <li><a href="#pre-session-task---loading-the-data" id="toc-pre-session-task---loading-the-data" class="nav-link" data-scroll-target="#pre-session-task---loading-the-data"><span class="header-section-number">1.2</span> Pre-session task - Loading the data</a></li>
  </ul>
</li>
  <li>
<a href="#choosing-appropriate-quantitative-tests" id="toc-choosing-appropriate-quantitative-tests" class="nav-link" data-scroll-target="#choosing-appropriate-quantitative-tests"><span class="header-section-number">2</span> Choosing appropriate quantitative tests</a>
  <ul class="collapse">
<li><a href="#task-1-plot-a-graph-of-mean-science-scores-by-country" id="toc-task-1-plot-a-graph-of-mean-science-scores-by-country" class="nav-link" data-scroll-target="#task-1-plot-a-graph-of-mean-science-scores-by-country"><span class="header-section-number">2.1</span> Task 1 Plot a graph of mean science scores by country</a></li>
  <li><a href="#task-2-are-there-differences-in-science-scores-by-gender-for-the-total-data-set" id="toc-task-2-are-there-differences-in-science-scores-by-gender-for-the-total-data-set" class="nav-link" data-scroll-target="#task-2-are-there-differences-in-science-scores-by-gender-for-the-total-data-set"><span class="header-section-number">2.2</span> Task 2 Are there differences in science scores by gender for the total data set?</a></li>
  <li><a href="#task-3-are-there-differences-in-science-scores-by-gender-for-uk-students" id="toc-task-3-are-there-differences-in-science-scores-by-gender-for-uk-students" class="nav-link" data-scroll-target="#task-3-are-there-differences-in-science-scores-by-gender-for-uk-students"><span class="header-section-number">2.3</span> Task 3 Are there differences in science scores by gender for UK students?</a></li>
  <li><a href="#task-4-for-the-whole-data-set-is-there-a-correlation-between-students-science-score-and-reading-scores" id="toc-task-4-for-the-whole-data-set-is-there-a-correlation-between-students-science-score-and-reading-scores" class="nav-link" data-scroll-target="#task-4-for-the-whole-data-set-is-there-a-correlation-between-students-science-score-and-reading-scores"><span class="header-section-number">2.4</span> Task 4 For the whole data set, is there a correlation between students’ science score and reading scores?</a></li>
  <li><a href="#task-5-plot-a-representation-of-uk-students-science-score-against-reading-score-with-a-linear-best-fit-line." id="toc-task-5-plot-a-representation-of-uk-students-science-score-against-reading-score-with-a-linear-best-fit-line." class="nav-link" data-scroll-target="#task-5-plot-a-representation-of-uk-students-science-score-against-reading-score-with-a-linear-best-fit-line."><span class="header-section-number">2.5</span> Task 5 Plot a representation of UK students’ science score against reading score, with a linear best fit line.</a></li>
  <li><a href="#task-6-do-girls-and-boys-in-the-uk-have-different-preferences-for-maths" id="toc-task-6-do-girls-and-boys-in-the-uk-have-different-preferences-for-maths" class="nav-link" data-scroll-target="#task-6-do-girls-and-boys-in-the-uk-have-different-preferences-for-maths"><span class="header-section-number">2.6</span> Task 6 Do girls and boys in the UK have different preferences for maths?</a></li>
  <li><a href="#task-7-does-mathematics-preferences-explain-variation-in-mathematics-score-for-uk-students" id="toc-task-7-does-mathematics-preferences-explain-variation-in-mathematics-score-for-uk-students" class="nav-link" data-scroll-target="#task-7-does-mathematics-preferences-explain-variation-in-mathematics-score-for-uk-students"><span class="header-section-number">2.7</span> Task 7 Does mathematics preferences explain variation in mathematics score for UK students?</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">11 Selecting statistical tools</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="pre-session-tasks" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Pre-session tasks</h1>
<section id="pre-session-reading" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="pre-session-reading">
<span class="header-section-number">1.1</span> Pre-session reading</h2>
<p>Look over the test selection flow chart:</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">DiagrammeR</span>(<span class="st">"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="st">    graph LR</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="st">     A[What do you want to do?]--&gt;B[Test a hypothesis - on what kind of data?];</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="st">     A--&gt;C[Examine a relationship];</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="st">     B--&gt;D[Continuous];</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="st">     D--&gt;E[Normally Distribured/Parametric];</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="st">     E--&gt;F[1 Group];</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="st">     F--&gt;G[One sample t-test];</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="st">     E--&gt;H[Do a test of normality];</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="st">     H--&gt;I[qqplot];</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="st">     D--&gt;J[Tests on skewed distributions];</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="st">     B--&gt;K[Discrete / Categorical];</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="st">     K--&gt;L[2 Groups];</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">     L--&gt;M[Unpaired groups];</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="st">     M--&gt;N[Expected counts more than 5 in more than 75 per cent of cells];</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="st">     N--&gt;O[Chi-square];</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="st">     M--&gt;P[Expected counts more than 5 in less than 75 per cent of cells];</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="st">     P--&gt;Q[Fisher exact test];</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="st">     D--&gt;R[Continuous variables];</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="st">     R--&gt;S[Linear Regression];</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="st">     E--&gt;T[2 groups]</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="st">     T--&gt;U[Paired groups]</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="st">     T--&gt;V[Unpaired groups]</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="st">     U--&gt;W[Paired t-test]</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="st">     V--&gt;X[Unpaired t-test]</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="st">      E--&gt;Y[3 groups or more]</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="st">    Y--&gt;Z[Anova]</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="st">    style G fill:#E5E25F;</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="st">    style I fill:#D62724D1;</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="st">    style J fill:#B6E6E6;</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="st">    style I fill:#B6E6E6;</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="st">    style W fill:#E5E25F;</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="st">    style X fill:#E5E25F;</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="st">    style Z fill:#E5E25F;</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="st">    style Q fill:#E5E25F;</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="st">    style O fill:#E5E25F;</span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="st">    style S fill:#E5E25F;</span></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="st">    "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="DiagrammeR html-widget html-fill-item" id="htmlwidget-dbfceed13e297bb14f02" style="width:95%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-dbfceed13e297bb14f02">{"x":{"diagram":"\n    graph LR\n     A[What do you want to do?]-->B[Test a hypothesis - on what kind of data?];\n     A-->C[Examine a relationship];\n     B-->D[Continuous];\n     D-->E[Normally Distribured/Parametric];\n     E-->F[1 Group];\n     F-->G[One sample t-test];\n     E-->H[Do a test of normality];\n     H-->I[qqplot];\n     D-->J[Tests on skewed distributions];\n     B-->K[Discrete / Categorical];\n     K-->L[2 Groups];\n     L-->M[Unpaired groups];\n     M-->N[Expected counts more than 5 in more than 75 per cent of cells];\n     N-->O[Chi-square];\n     M-->P[Expected counts more than 5 in less than 75 per cent of cells];\n     P-->Q[Fisher exact test];\n     D-->R[Continuous variables];\n     R-->S[Linear Regression];\n     E-->T[2 groups]\n     T-->U[Paired groups]\n     T-->V[Unpaired groups]\n     U-->W[Paired t-test]\n     V-->X[Unpaired t-test]\n      E-->Y[3 groups or more]\n    Y-->Z[Anova]\n    style G fill:#E5E25F;\n    style I fill:#D62724D1;\n    style J fill:#B6E6E6;\n    style I fill:#B6E6E6;\n    style W fill:#E5E25F;\n    style X fill:#E5E25F;\n    style Z fill:#E5E25F;\n    style Q fill:#E5E25F;\n    style O fill:#E5E25F;\n    style S fill:#E5E25F;\n    "},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section><section id="pre-session-task---loading-the-data" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="pre-session-task---loading-the-data">
<span class="header-section-number">1.2</span> Pre-session task - Loading the data</h2>
<p>We will continue to use the PISA_2018 dataset, make sure it is loaded.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load PISA data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(arrow)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>PISA_2022 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(r<span class="st">"[&lt;folder&gt;PISA_2018_student_subset.parquet]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="choosing-appropriate-quantitative-tests" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Choosing appropriate quantitative tests</h1>
<p>In the lecture, this flow chart was introduced (which us produced using R code here - unfold the code to see how this is done using the <code>DiagrammeR</code> package)</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">DiagrammeR</span>(<span class="st">"</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">    graph LR</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">     A[What do you want to do?]--&gt;B[Test a hypothesis - on what kind of data?];</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">     A--&gt;C[Examine a relationship];</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="st">     B--&gt;D[Continuous];</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="st">     D--&gt;E[Normally Distribured/Parametric];</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="st">     E--&gt;F[1 Group];</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="st">     F--&gt;G[One sample t-test];</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">     E--&gt;H[Do a test of normality];</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="st">     H--&gt;I[qqplot];</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">     D--&gt;J[Tests on skewed distributions];</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">     B--&gt;K[Discrete / Categorical];</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">     K--&gt;L[2 Groups];</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">     L--&gt;M[Unpaired groups];</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="st">     M--&gt;N[Expected counts more than 5 in more than 75 per cent of cells];</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="st">     N--&gt;O[Chi-square];</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="st">     M--&gt;P[Expected counts more than 5 in less than 75 per cent of cells];</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="st">     P--&gt;Q[Fisher exact test];</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="st">     D--&gt;R[Continuous variables];</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="st">     R--&gt;S[Linear Regression];</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="st">     E--&gt;T[2 groups]</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="st">     T--&gt;U[Paired groups]</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="st">     T--&gt;V[Unpaired groups]</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="st">     U--&gt;W[Paired t-test]</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">     V--&gt;X[Unpaired t-test]</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="st">      E--&gt;Y[3 groups or more]</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">    Y--&gt;Z[Anova]</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="st">    style G fill:#E5E25F;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">    style I fill:#D62724D1;</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="st">    style J fill:#B6E6E6;</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="st">    style I fill:#B6E6E6;</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="st">    style W fill:#E5E25F;</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="st">    style X fill:#E5E25F;</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="st">    style Z fill:#E5E25F;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="st">    style Q fill:#E5E25F;</span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="st">    style O fill:#E5E25F;</span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="st">    style S fill:#E5E25F;</span></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="st">    "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="DiagrammeR html-widget html-fill-item" id="htmlwidget-53cac8160b6f9a3a319b" style="width:95%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-53cac8160b6f9a3a319b">{"x":{"diagram":"\n    graph LR\n     A[What do you want to do?]-->B[Test a hypothesis - on what kind of data?];\n     A-->C[Examine a relationship];\n     B-->D[Continuous];\n     D-->E[Normally Distribured/Parametric];\n     E-->F[1 Group];\n     F-->G[One sample t-test];\n     E-->H[Do a test of normality];\n     H-->I[qqplot];\n     D-->J[Tests on skewed distributions];\n     B-->K[Discrete / Categorical];\n     K-->L[2 Groups];\n     L-->M[Unpaired groups];\n     M-->N[Expected counts more than 5 in more than 75 per cent of cells];\n     N-->O[Chi-square];\n     M-->P[Expected counts more than 5 in less than 75 per cent of cells];\n     P-->Q[Fisher exact test];\n     D-->R[Continuous variables];\n     R-->S[Linear Regression];\n     E-->T[2 groups]\n     T-->U[Paired groups]\n     T-->V[Unpaired groups]\n     U-->W[Paired t-test]\n     V-->X[Unpaired t-test]\n      E-->Y[3 groups or more]\n    Y-->Z[Anova]\n    style G fill:#E5E25F;\n    style I fill:#D62724D1;\n    style J fill:#B6E6E6;\n    style I fill:#B6E6E6;\n    style W fill:#E5E25F;\n    style X fill:#E5E25F;\n    style Z fill:#E5E25F;\n    style Q fill:#E5E25F;\n    style O fill:#E5E25F;\n    style S fill:#E5E25F;\n    "},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>That chart will help you choose the test to use for the tasks below. # Seminar Tasks</p>
<section id="task-1-plot-a-graph-of-mean-science-scores-by-country" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="task-1-plot-a-graph-of-mean-science-scores-by-country">
<span class="header-section-number">2.1</span> Task 1 Plot a graph of mean science scores by country</h2>
<p>Imagine we wish to compare the mean scores of students on the science element of PISA by plotting a bar graph. First you need to use the <code>sumarise</code> function to calculate means by countries. Then use ggplot with <code>geom_col</code> to create the graph. <strong><em>Extension task:</em></strong> add error bars for the standard deviations of science scores.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Task 1: Plot a graph of mean science scores by country</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Create a variable avgscience - for every country (Group_by(CNT)) calculate the mean</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># science score (PV1SCIE) and ignore NA (na.rm=TRUE)</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>avgscience <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">summarise</span>(<span class="at">mean_sci =</span> <span class="fu">mean</span>(PV1SCIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Arrange in descending order  </span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_sci))</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># Plot the data in avgscience, x=CNT (reorder to ascending order), mean science score on the y</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># Change the fill colour to red, rotate the text, locate the text and reduce the font size</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="fu">ggplot</span>(<span class="at">data =</span> avgscience, </span>
<span id="cb4-14"><a href="#cb4-14"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(CNT, <span class="sc">-</span> mean_sci), <span class="at">y =</span> mean_sci)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.95</span>, <span class="at">vjust =</span> <span class="fl">0.2</span>, </span>
<span id="cb4-17"><a href="#cb4-17"></a>                                 <span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Mean Science Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="11-selecting_statistical_tools_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Extension version: added summarise to find standard deviation </span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>avgscience <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">summarise</span>(<span class="at">mean_sci =</span> <span class="fu">mean</span>(PV1SCIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-6"><a href="#cb5-6"></a>            <span class="at">sd_sci =</span> <span class="fu">sd</span>(PV1SCIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_sci))</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># Extension version: geom_errorbar added with aes y=mean_sci (the centre of the bar) and then the maximum and minimum set to the mean plus or minus the standard deviation (ymin=mean_sci-sd_sci, ymax=mean_sci+sd_sci) </span></span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">ggplot</span>(<span class="at">data =</span> avgscience, </span>
<span id="cb5-12"><a href="#cb5-12"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(CNT, <span class="sc">-</span>mean_sci), <span class="at">y =</span> mean_sci)) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="fl">0.95</span>, <span class="at">vjust =</span> <span class="fl">0.2</span>, </span>
<span id="cb5-15"><a href="#cb5-15"></a>                                 <span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Mean Science Score"</span>)<span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_sci, <span class="at">ymin =</span> mean_sci<span class="sc">-</span>sd_sci, </span>
<span id="cb5-18"><a href="#cb5-18"></a>                    <span class="at">ymax =</span> mean_sci<span class="sc">+</span>sd_sci), </span>
<span id="cb5-19"><a href="#cb5-19"></a>                <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">colour=</span><span class="st">'black'</span>, <span class="at">size =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="11-selecting_statistical_tools_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section><section id="task-2-are-there-differences-in-science-scores-by-gender-for-the-total-data-set" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="task-2-are-there-differences-in-science-scores-by-gender-for-the-total-data-set">
<span class="header-section-number">2.2</span> Task 2 Are there differences in science scores by gender for the total data set?</h2>
<p>Consider the kinds of variables that represent the science score. What is an appropriate test to determine differences in the means between the two groups? Create two vectors, for boys and girls, that you can feed into the <code>t.test</code> function.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Task 2: Are there differences in Science scores by gender for the total data set? (Yes)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># A comparison of means of two continuous variables, use a t-test.</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># Choose the  gender (ST004D01T) and science score columns (PV1SCIE) from  2018 data, filter for males </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Put that data into MaleSci</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>MaleSci <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">select</span>(ST004D01T, PV1SCIE) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">filter</span>(ST004D01T <span class="sc">==</span> <span class="st">"Male"</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co"># Choose the  gender (ST004D01T) and science score columns (PV1SCIE) from  2018 data, filter for females </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Put that data into FemaleSci</span></span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a>FemaleSci <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">select</span>(CNT, ST004D01T, PV1SCIE) <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">filter</span>(ST004D01T <span class="sc">==</span> <span class="st">"Female"</span>)</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#Do a t-test comparing MaleSci and FemaleSci</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="fu">t.test</span>(MaleSci<span class="sc">$</span>PV1SCIE, FemaleSci<span class="sc">$</span>PV1SCIE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  MaleSci$PV1SCIE and FemaleSci$PV1SCIE
t = -9.3337, df = 610738, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -3.033446 -1.980566
sample estimates:
mean of x mean of y 
 449.2026  451.7096 </code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># p-value is &lt; 2.2e-16 which is less than 0.05 so statistically singficant differences exist</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="task-3-are-there-differences-in-science-scores-by-gender-for-uk-students" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="task-3-are-there-differences-in-science-scores-by-gender-for-uk-students">
<span class="header-section-number">2.3</span> Task 3 Are there differences in science scores by gender for UK students?</h2>
<p>As above, but include a filter by country.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Task 3: Are there differences in Science scores by gender for UK students? (No)</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># A comparision of means of two continuous variables, use a t-test.</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Choose the country (CNT), gender (ST004D01T) and science score columns (PV1SCIE) from  2018 data, filter for males and the UK</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Put that data into UKMaleSci</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>UKMaleSci <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">select</span>(CNT, ST004D01T, PV1SCIE) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">filter</span>(ST004D01T <span class="sc">==</span> <span class="st">"Male"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># Choose the country (CNT), gender (ST004D01T) and science score columns (PV1SCIE) from  2018 data, filter for females and the UK</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co"># Put that data into UKFemaleSci</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>UKFemaleSci <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">select</span>(CNT, ST004D01T, PV1SCIE) <span class="sc">%&gt;%</span> </span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="fu">filter</span>(ST004D01T <span class="sc">==</span> <span class="st">"Female"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)</span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co"># Do a t-test comparing UKMaleSci and UKFemaleSci</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="fu">t.test</span>(UKMaleSci<span class="sc">$</span>PV1SCIE, UKFemaleSci<span class="sc">$</span>PV1SCIE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  UKMaleSci$PV1SCIE and UKFemaleSci$PV1SCIE
t = 3.9298, df = 12964, p-value = 8.547e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  3.529142 10.553500
sample estimates:
mean of x mean of y 
 495.7375  488.6962 </code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># the p-value is 0.1267 over, 0.05, so statistically signficant differences between males and females</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="task-4-for-the-whole-data-set-is-there-a-correlation-between-students-science-score-and-reading-scores" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="task-4-for-the-whole-data-set-is-there-a-correlation-between-students-science-score-and-reading-scores">
<span class="header-section-number">2.4</span> Task 4 For the whole data set, is there a correlation between students’ science score and reading scores?</h2>
<p>Reflect on the appropriate test to show correlation between two scores. This test can be carried out quite simply using a couple of lines of code. <strong><em>Extensions:</em></strong> a) perform the same analysis, but consider the impact of gender; b) Find the correlations between reading and science core by country, and rank from most highly correlated to least.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Task 4: For the whole data set, is there a correlation between students’ science score reading score? (Yes, significant 0.77)</span></span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># Do the regression test between science score (PV1SCIE) and reading score (PV1READ) on the PISA_2018 data</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>lmSciRead <span class="ot">&lt;-</span> <span class="fu">lm</span>(PV1SCIE <span class="sc">~</span> PV1READ, <span class="at">data =</span> PISA_2022)</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">summary</span>(lmSciRead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1SCIE ~ PV1READ, data = PISA_2022)

Residuals:
    Min      1Q  Median      3Q     Max 
-348.75  -38.22   -1.08   37.50  384.95 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 97.890279   0.303098     323   &lt;2e-16 ***
PV1READ      0.804547   0.000671    1199   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 57.57 on 613742 degrees of freedom
Multiple R-squared:  0.7008,    Adjusted R-squared:  0.7008 
F-statistic: 1.438e+06 on 1 and 613742 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Extension 1: Add Gender:</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>lmSciRead <span class="ot">&lt;-</span> <span class="fu">lm</span>(PV1SCIE <span class="sc">~</span> PV1READ <span class="sc">+</span> ST004D01T, <span class="at">data=</span>PISA_2022)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="fu">summary</span>(lmSciRead)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1SCIE ~ PV1READ + ST004D01T, data = PISA_2022)

Residuals:
    Min      1Q  Median      3Q     Max 
-358.01  -37.74   -0.83   37.13  376.71 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.486e+01  3.180e-01   266.9   &lt;2e-16 ***
PV1READ       8.139e-01  6.674e-04  1219.4   &lt;2e-16 ***
ST004D01TMale 1.785e+01  1.462e-01   122.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 56.88 on 613662 degrees of freedom
  (79 observations deleted due to missingness)
Multiple R-squared:  0.7079,    Adjusted R-squared:  0.7079 
F-statistic: 7.436e+05 on 2 and 613662 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Extentions 2: Rank by correlation</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>CNTPISA <span class="ot">&lt;-</span> PISA_2022<span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">select</span>(CNT, PV1SCIE, PV1READ)<span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">group_by</span>(CNT)<span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">summarise</span>(<span class="at">MeanSci=</span><span class="fu">mean</span>(PV1SCIE),</span>
<span id="cb16-6"><a href="#cb16-6"></a>            <span class="at">MeanRead=</span><span class="fu">mean</span>(PV1READ),</span>
<span id="cb16-7"><a href="#cb16-7"></a>            <span class="at">Cor=</span><span class="fu">cor</span>(PV1SCIE,PV1READ)) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Cor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="task-5-plot-a-representation-of-uk-students-science-score-against-reading-score-with-a-linear-best-fit-line." class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="task-5-plot-a-representation-of-uk-students-science-score-against-reading-score-with-a-linear-best-fit-line.">
<span class="header-section-number">2.5</span> Task 5 Plot a representation of UK students’ science score against reading score, with a linear best fit line.</h2>
<p>It will help here to create a <code>data.frame</code> that contains a filtered version of the whole dataset you can pass to <code>ggplot</code>.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Task 5: Plot a representation of UK students’ science score against reading score.</span></span>
<span id="cb17-2"><a href="#cb17-2"></a> </span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co"># Choose the three variables of interest, science score (PV1SCIE), reading score (PV1READ) and country (CNT)</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># and filter for the UK. Put the values into regplotdata</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>regplotdata <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">select</span>(PV1SCIE, PV1READ, CNT) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co"># Plot the data in regplotdata, set the science score on the x-xis and reading on y-axis, set the size, colour and alpha (transparency)</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co"># of points and add a linear ('lm') black line</span></span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="fu">ggplot</span>(<span class="at">data =</span> regplotdata, </span>
<span id="cb17-13"><a href="#cb17-13"></a>       <span class="fu">aes</span>(<span class="at">x =</span> PV1SCIE, <span class="at">y =</span> PV1READ)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">colour=</span><span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Science Score"</span>, <span class="at">y =</span> <span class="st">"Reading score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="11-selecting_statistical_tools_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section><section id="task-6-do-girls-and-boys-in-the-uk-have-different-preferences-for-maths" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="task-6-do-girls-and-boys-in-the-uk-have-different-preferences-for-maths">
<span class="header-section-number">2.6</span> Task 6 Do girls and boys in the UK have different preferences for maths?</h2>
<p>The PISA 2022 data set includes the variable <code>MATHPREF</code> (Preference of Math over other core subjects). Determine if the data for girls and boys are homogenous (i.e.&nbsp;if the null hypothesis that girls and boys have similar preferences for maths). Note the possible responses are: <code>0</code> No preference for mathematics over other subjects and <code>1</code> Preference for mathematics over other subjects</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Task 6: Is there a relationship between UK boys' and girls' mathematics preferences</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  </span>
<span id="cb18-3"><a href="#cb18-3"></a>chi_data <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">select</span>(CNT, ST004D01T, MATHPREF) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">droplevels</span>()<span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co"># We wish to compare two categorical variables, gender (Male/Female) and preference for maths (0 = No Preference for maths/ 1= Preference for maths)</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co"># Create a frequency table</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>Mathpreftable <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="at">data=</span>chi_data, <span class="sc">~</span> ST004D01T <span class="sc">+</span> MATHPREF)</span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co"># Perform the chisq.test on the data</span></span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="fu">chisq.test</span>(Mathpreftable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  Mathpreftable
X-squared = 29.898, df = 1, p-value = 4.554e-08</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># p-value= 4.554e-08 - reject the null hypothesis - boys and girls have different preferences for mathematics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="task-7-does-mathematics-preferences-explain-variation-in-mathematics-score-for-uk-students" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="task-7-does-mathematics-preferences-explain-variation-in-mathematics-score-for-uk-students">
<span class="header-section-number">2.7</span> Task 7 Does mathematics preferences explain variation in mathematics score for UK students?</h2>
<p>Arguments have been made the students who know more science, might engage in more environmental activism. Determine what percentage of variation in UK mathematics scores is explained by a) the variable <code>MATHPREF</code> (Preference of Math over other core subjectsn); b) <code>MATHEASE</code> (Perception of Mathematics as easier than other subjects); and c) <code>MATHMOT</code> (Motivation to do well in mathematics ).</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Task 7: How much variability in mathematics score is explained by attitude to maths variables for UK respondents</span></span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>UK_data <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">select</span>(CNT, PV1MATH, MATHPREF, MATHMOT, MATHEASE) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co"># Perform the anova test</span></span>
<span id="cb21-9"><a href="#cb21-9"></a>resaov <span class="ot">&lt;-</span> <span class="fu">aov</span>(<span class="at">data =</span> UK_data, </span>
<span id="cb21-10"><a href="#cb21-10"></a>              PV1MATH <span class="sc">~</span> MATHPREF <span class="sc">+</span> MATHMOT <span class="sc">+</span> MATHEASE)</span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="fu">summary</span>(resaov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>               Df   Sum Sq Mean Sq F value   Pr(&gt;F)    
MATHPREF        1   981096  981096 108.868  &lt; 2e-16 ***
MATHMOT         1    39980   39980   4.436   0.0352 *  
MATHEASE        1   247557  247557  27.470 1.63e-07 ***
Residuals   10579 95335543    9012                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#&gt; Significant differences exist for MATHPREF and MATHEASE, but not for MATHMOT (Motivation to do well in mathematics)</span></span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># Determine the % of variation explained</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">library</span>(lsr)</span>
<span id="cb23-5"><a href="#cb23-5"></a>eta <span class="ot">&lt;-</span> <span class="fu">etaSquared</span>(resaov)</span>
<span id="cb23-6"><a href="#cb23-6"></a>eta <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>eta</span>
<span id="cb23-7"><a href="#cb23-7"></a>eta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             eta.sq eta.sq.part
MATHPREF 0.53998100  0.54418893
MATHMOT  0.06829671  0.06915768
MATHEASE 0.25625926  0.25899678</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># MATHPREF explains only 0.54% of the variance, and MATHEASE, 0.26% (MATHMOT is not significant)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>